define([],function(){var e=Backbone.View.extend({id:"settings",className:"hide",hasChanged:[],bufferValues:[256,512,1024,2048,4096,8192,16384],initialize:function(){_.bindAll(this),this.valid=!1,this.$container=this.options.$container,this.template=env==="web"?_.template($("#settings-template").html()):templates.settings_template,this.model.on("show",this.onShow),this.render(),global_relay.on("global-exit",this.onHide),this.$el.find("#buffer-size").on("blur",this.validateBufferSize)},render:function(){this.$el.html(this.template(this.model.toJSON())),this.$container.append(this.$el)},validateBufferSize:function(e){_.contains(this.bufferValues,parseInt(e.target.value,10))?(this.valid=!0,$(e.target).removeClass("setting-error")):$(e.target).addClass("setting-error")},onHide:function(){var e=this,t={},n=this.$el.find("input");this.valid=!1,this.hasChanged=[],n.blur().each(function(){var n=this.getAttribute("data-setting");e.model.get(n)!=this.value&&e.hasChanged.push(n),t[n]=this.value}),this.valid&&(this.model.set(t),this.model.save(function(){_.contains(e.hasChanged,"bufferSize")&&e.model.trigger("restart"),e.$el.addClass("hide")}))},onShow:function(){this.$el.removeClass("hide")}});return e});