define(["modules/BaseModule","components/ScriptNode"],function(e,t){var n={MAX_BITS:32},r=e.extend({init:function(){this._super.apply(this,arguments);var e=new t(this.context,512,2,2),n=this;this._bits=8,this.setLabel("Bitcrusher"),this.connectToInput(e),this.connectToOutput(e),this.nodes.bitcrusher=e,e.onAudioProcess(function(e){n.calculate(e)})},calculate:function(e){var t=e.outputBuffer,r=e.inputBuffer.getChannelData(0),i=e.inputBuffer.getChannelData(1),s=t.getChannelData(0),o=t.getChannelData(1),u=t.length,a=n.MAX_BITS/this._bits,f=0;for(var l=0;l<u;l+=a){var c=r[l],h=i[l];for(f=0;f<a;f++)s[l+f]=c,o[l+f]=h}},setBits:function(e){n.MAX_BITS%e||(this._bits=e)}});return r});