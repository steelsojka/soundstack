(function(e){var t="RecorderWorker.js",n=function(e,n){var r=n||{},i=r.bufferLen||4096;this.context=e.context,this.node=this.context.createJavaScriptNode(i,2,2);var s=new Worker(r.workerPath||t);s.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}});var o=!1,u;this.node.onaudioprocess=function(e){if(!o)return;s.postMessage({command:"record",buffer:[e.inputBuffer.getChannelData(0),e.inputBuffer.getChannelData(1)]})},this.configure=function(e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])},this.record=function(){o=!0},this.stop=function(){o=!1},this.clear=function(){s.postMessage({command:"clear"})},this.getBuffer=function(e){u=e||r.callback,s.postMessage({command:"getBuffer"})},this.exportWAV=function(e,t,n){u=e||r.callback,t=t||r.type||"audio/wav";if(!u)throw new Error("Callback not set");s.postMessage({command:"exportWAV",type:t,buffers:n})},s.onmessage=function(e){var t=e.data;u(t)},e.connect(this.node),this.node.connect(this.context.destination)};n.forceDownload=function(t,n){var r=(e.URL||e.webkitURL).createObjectURL(t),i=e.document.createElement("a");i.href=r,i.download=n||"output.wav";var s=document.createEvent("Event");s.initEvent("click",!0,!0),i.dispatchEvent(s)},e.Recorder=n})(window);